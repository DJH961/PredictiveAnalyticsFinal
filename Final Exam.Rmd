---
title: "Predictive Analytics - Final Exam"
date: "13/06/2025"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  out.width = "60%",
  message = FALSE
)

library(tidyverse)
library(urca)
library(fpp3)
```

## Data Loading and Exploration

```{r loading}
df1 <- read_csv("wikipedia_2007-2015.csv", show_col_types = FALSE) 
df2 <- read_csv("wikipedia_2016-2025.csv", show_col_types = FALSE)

df1 <- df1 %>%
  filter(as_date(month) != as_date("2016-01-01"))

clicks_raw <- bind_rows(df1, df2) %>%
  transmute(
    date = as_date(month),
    clicks = total.total    
  ) %>%
  arrange(date)
```

```{r exploration}
glimpse(clicks_raw)
summary(clicks_raw)
clicks_raw %>% ggplot(aes(x = date, y = clicks)) + geom_line()
```

```{r check_duplicates}
clicks_raw %>%
  count(date) %>%
  filter(n > 1)
```

```{r check_missing}
clicks_raw %>%
  filter(is.na(clicks)) %>%
  select(date, clicks)
```

```{r daily}
clicks_daily <- clicks_raw
```

```{r weekly_aggregation}
clicks_weekly <- clicks_raw %>%
  mutate(week = floor_date(date, unit = "week")) %>%
  group_by(week) %>%
  summarise(clicks = sum(clicks, na.rm = TRUE)) %>%
  ungroup() %>%
  rename(date = week)

```

```{r monthly_aggrgation}
clicks_monthly <- clicks_raw %>%
  mutate(month = floor_date(date, unit = "month")) %>%
  group_by(month) %>%
  summarise(clicks = sum(clicks, na.rm = TRUE)) %>%
  ungroup() %>%
  rename(date = month)

```


```{r comparison}
clicks_daily %>% ggplot(aes(x = date, y = clicks)) + geom_line() + ggtitle("Daily Clicks")
clicks_weekly %>% ggplot(aes(x = date, y = clicks)) + geom_line() + ggtitle("Weekly Clicks")
clicks_monthly %>% ggplot(aes(x = date, y = clicks)) + geom_line() + ggtitle("Monthly Clicks")

```

