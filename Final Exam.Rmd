---
title: "Predictive Analytics - Final Exam"
date: "13/06/2025"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  out.width = "60%",
  message = FALSE
)

library(tidyverse)
library(urca)
library(fpp3)
```

## Data Loading and Exploration

```{r loading}
df1 <- read_csv("wikipedia_2007-2015.csv", show_col_types = FALSE) 
df2 <- read_csv("wikipedia_2016-2025.csv", show_col_types = FALSE)

df1 <- df1 %>%
  filter(as_date(month) < as_date("2016-01-01"))

df2 <- df2 %>%
  filter(as_date(month) < as_date("2025-06-01"))

views_raw <- bind_rows(df1, df2) %>%
  transmute(
    date = as_date(month),
    views = total.total    
  ) %>%
  arrange(date)
```

```{r exploration}
glimpse(views_raw)
summary(views_raw)
views_raw %>% ggplot(aes(x = date, y = views)) + geom_line()
```

```{r check_duplicates}
views_raw %>%
  count(date) %>%
  filter(n > 1)
```

```{r check_missing}
views_raw %>%
  filter(is.na(views)) %>%
  select(date, views)
```

```{r daily}
views_daily <- views_raw
```

```{r weekly_aggregation}
views_weekly <- views_raw %>%
  mutate(week = floor_date(date, unit = "week")) %>%
  group_by(week) %>%
  summarise(views = sum(views, na.rm = TRUE)) %>%
  ungroup() %>%
  rename(date = week)

```

```{r monthly_aggrgation}
views_monthly <- views_raw %>%
  mutate(month = floor_date(date, unit = "month")) %>%
  group_by(month) %>%
  summarise(views = sum(views, na.rm = TRUE)) %>%
  ungroup() %>%
  rename(date = month)

```


```{r comparison}
views_daily %>% ggplot(aes(x = date, y = views)) + geom_line() + ggtitle("Daily Views")
views_weekly %>% ggplot(aes(x = date, y = views)) + geom_line() + ggtitle("Weekly Views")
views_monthly %>% ggplot(aes(x = date, y = views)) + geom_line() + ggtitle("Monthly Views")

```

